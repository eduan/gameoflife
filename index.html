<html>
	<head>
		<!--script src='http://code.jquery.com/jquery-1.9.1.min.js'></script-->
		<script src='zepto.min.js'></script>
		<script type='text/javascript'>
			var x = 20;
			var y = 23;
			var celulas = Array(x);
			var frames = 0;

			function inicializarCelulas(){
				//inicializar celulas
				for(var i=0;i<x;i++){
					celulas[i] = Array(y);
					for(var j=0;j<y;j++){
						celulas[i][j] = 0;
					}
				}	
			}
		
			function visualizarCelulas(){
				//inicializar celulas
				for(var i=0;i<x;i++){
					console.log(JSON.stringify(celulas[i]));
				}	
			}

			function reagir(a,b){
				var vizinhos = 0;
 				for(var h = a-1; h < a+2; h++){
					for(var k = b-1; k < b+2; k++){
						console.log('['+h+','+k+']');
						if(celulas[h][k]){
							vizinhos++;
						}
					}
				}	

				if((vizinhos<2 || vizinhos >3) && celulas[a][b]){
					celulas[a][b] = false;
				}else if(vizinhos == 3 && !celulas[a][b]){
					celulas[a][b] = true;
				}
			}


			function inicializarEventos(){
				$('td').click(function(){
					var i = $(this).attr('i');
					var j = $(this).attr('j');
					celulas[i][j] = !celulas[i][j];
					$(this).toggleClass('viva');
				})
			}

			

			function renderizarTabuleiro(){
				$('.counter').text(frames++);
				//inicializando tabuleiro
				console.log('renderizarTabuleiro');
				$("#tabuleiro").empty();
				for(var i=0;i<x;i++){
					var coluna = $('<tr/>');
					var linha = $('<td/>');
					for(var j=0;j<y;j++){
						
						reagir(i,j);

						linha.removeClass('viva');

						if(celulas[i][j]){
							linha.addClass('viva');	
						}

						linha.attr('i', i).attr('j', j);
						coluna.append(linha.clone());
						linha.detach();
					}

				    $("#tabuleiro").append(coluna.clone());
				    coluna.detach();
				}	
				
				inicializarEventos();

			}

			$(function(){
				
				inicializarCelulas();

				setInterval('renderizarTabuleiro()',1000);

			})	
		</script>
		<style type='text/css'>      
			table{ 
				border-bottom:1px solid #ccc;  
				border-left:1px solid #ccc; 
			}
			
			table * { 
				cursor:pointer; 
			}

			td {
				border:1px solid #ccc; 
				width:10px;
				height:10px; 
				border-bottom:none; 
				border-left:none;
			}

			td {
				background-color: white;
			}
			
			td.viva {
				background-color: black;
			}
		</style>
	</head>
	<body>
	  <table id='tabuleiro' cellpadding='1' cellspacing='0'>
	    
	  </table>
	  <span class='counter'>0</span>
	</body>
</html>
